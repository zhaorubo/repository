<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>ThisB</title>
    </head>
    <body>
        <button class="btn">点我回去A</button>
    </body>
    <script>
        let btn = document.querySelector('.btn')

        // back A button
        btn.addEventListener('click', function () {
            location.assign('./ThisA.html')
        })

        // 处理字符串
        let str = decodeURIComponent(location.search)
        console.log(location.search)
        str = str.slice(1)
        let obj = {}
        // console.log(str)
        str.split('&').forEach((ele, index) => {
            let arr = ele.split('=')
            obj[arr[0]] = arr[1]
        })
        console.log(obj)

        // sex to Chinese
        if (obj.sex == 'man') {
            obj.sex = '男士'
        } else {
            obj.sex = '女士'
        }

        // password
        let first = obj.password.substr(0, 1) // first
        let last = obj.password.substr(-1, 1) // last
        let newPass = obj.password.substr(1)
        console.log(obj.password)
        let newstr = ''
        newPass = newPass.substr(0, newPass.length - 1)
        for (let i = 0; i < newPass.length - 2; i++) {
            newstr += '*'
        }
        console.log(newstr)

        // money
        // console.log(obj.money / 1000)
        for (let i = 0; i < obj.money.length; i++) {}

        // Time
        let date = new Date(parseInt(obj.time))
        let year = date.getFullYear()
        let month = date.getMonth() + 1
        let day1 = date.getDate() // 日期
        let hour = date.getHours()
        let minute = date.getMinutes()
        let second = date.getSeconds()
        let Time = `${year}-${month < 10 ? '0' + month : month}-${day1 < 10 ? '0' + day1 : day1} ${
            hour < 10 ? '0' + hour : hour
        }:${minute < 10 ? '0' + minute : minute}:${second < 10 ? '0' + second : second}`
        // console.log(Time)

        // moreString
        let textObj = {}
        for (let i = 0; i < obj.textarea.length; i++) {
            if (textObj[obj.textarea[i]]) {
                textObj[obj.textarea[i]]++
            } else {
                textObj[obj.textarea[i]] = 1
            }
        }
        let max = 0
        let maxStr = ''
        let nextMaxNum = 0
        let nextMaxStr = 0
        for (const key in textObj) {
            if (textObj[key] > max) {
                max = textObj[key]
                maxStr = key
            }
            if (max == textObj[key] && maxStr != key) {
                nextMaxNum = textObj[key]
                nextMaxStr = key
            }
        }

        let strr = `<p><span>最多的字符是：${nextMaxStr}</span>\n<span>出现的次数是：${nextMaxNum}</span></p>`
        // console.log(nextMaxStr)
        // console.log(textObj)
        // let a = decodeURIComponent(
        //     'name=zhaorubo&password=&sex=man&money=65432212&textarea=%E8%B5%B5%E6%B1%9D%E6%B3%A2&time=1654076904488'
        // )

        // 渲染
        document.body.innerHTML += `
                                        <div>
                                          <p>姓名：${obj.name}\n ${obj.sex}</p>
                                          <p>密码：${first}${newstr}${last}</p>
                                          <p>金额：$${obj.money}</p>
                                          <p>填写时间：${Time}</p>
                                          <p>填写内容：${obj.textarea}</p>
                                          <p><span>最多的字符是：${maxStr}</span>\n<span>出现的次数是：${max}</span></p>
                                              ${nextMaxNum != 0 ? strr : ''}
                                          </div>

                                   `
    </script>
</html>
