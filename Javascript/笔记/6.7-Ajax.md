# Ajax (Asynchronous JavaScript and XML)

-   传统方法的缺陷
    -   > 传统的 web 交互是用户触发一个 http 请求服务器,然后服务器收到之后,在做出响应到用户,并且返回一个新的页面,,每当服务器处理客户端提交的请求时,客户都只能空闲等待,并且哪怕只是一次很小的交互、只需从服务器端得到很简单的一个数据,都要返回一个完整的 HTML 页,而用户每次都要浪费时间和带宽去重新读取整个页面。这个做法浪费了许多带宽，由于每次应用的交互都需要向服务器发送请求，应用的响应时间就依赖于服务器的响应时间。这导致了用户界面的响应比本地应用慢得多。
-   Ajax 的出现
    -   > ajax 的出现,刚好解决了传统方法的缺陷。AJAX 是一种用于创建快速动态网页的技术。通过在后台与服务器进行少量数据交换，AJAX 可以使网页实现异步更新。这意味着可以在不重新加载整个网页的情况下，对网页的某部分进行更新。

**AJAX 全称为 Asynchronous JavaScript And XML，就是异步的 JS 和 XML。 通过 AJAX 可以在浏览器中向服务器发送异步请求，最大的优势：无刷新获取数据。 AJAX 不是新的编程语言，而是一种将现有的标准组合在一起使用的新方式。**

> ajax(Asynchronous JavaScript and XML) 是一个工具。作用是用来更新网页数据，无需刷新网页

> 之前都是服务端直出 数据（存放数据库）和结构结合 一起返回给浏览器去渲染网页 javaweb php

> 出现前后端分离 前端：制作页面+交互（空架子） 后端：数据处理 ajax 前后端的桥梁 拉去后端的数据 在前端页面渲染数据

> ajax 不是一门编程语言 是一个技术的结合体 (Asynchronous JavaScript and XML)

## Ajax 的使用

-   ajax
    -   open(请求方式, URL, 是否异步)
    -   send(请求体)
    -   onreadystatechange，指定监听函数，它会在-xmlHttp 对象的状态发生变化时被调用
    -   readyState，当前 xmlHttp 对象的状态，其中 4 状态表示服务器响应结束
    -   status：服务器响应的状态码，只有服务器响应结束时才有这个东东，200 表示响应成功；
    -   responseText：获取服务器的响应体

```
// 1. 联系快递员
let xhr = new XMLHttpRequest()
// 2. 填写快递信息(填写真实后台地址（临时处理）)
let url = './data.json'
// 3. 给钱 请求方式 1.GET/POST  2.地址 3.同步或者异步 默认false 异步
// 通常情况下，只设置前两个参数即可
xhr.open('GET', url)
// 4. 发货
xhr.send()
// 前面四步完成了ajax的一半流程， 发送获取数据请求
// 服务器做出对应的处理后，返回数据给你
// 5. 收货 （设置一个监听事件，监听数据回来了）
xhr.addEventListener('readystatechange', function () {
    // 数据回来了就自动触发函数
    // 6. 拆快递，验收，使用
    // DOM操作 将数据渲染到页面中
    // readyState => ajax工具的一个状态标志
    // readyState => 1 工具被实例
    // readyState => 2 open的过程
    // readyState => 3 send的过程
    // readyState => 4 当数据回来的时候
    // 当 readyState 等于 4 说明工具正常进行
    // 工具正常不代表数据一定回来
    // 数据依赖网络传输数据（http协议）
    // status 代表http状态码
    // 当 200 代表网络是正常的
    if (xhr.readyState == 4 && xhr.status == 200) {
        // 数据渲染
        let data = xhr.responseText
        console.log(data)
    }
})
```

## get

```
let xhr = new XMLHttpRequest()
let url = 'http://netease.0melon0.cn/search?keywords="周杰伦"&limit=10'
xhr.open('get', url)
xhr.send()
xhr.addEventListener('readystatechange', function () {
    if (xhr.readyState == 4 && xhr.status == 200) {
        let data = JSON.parse(xhr.responseText)
        console.log(data)
    }
})
```

## post

```
let xhr = new XMLHttpRequest()
let url = 'http://eggblog.0melon0.cn/api/user/login'
xhr.open('post', url)
let a = {
    phone: '13680623397',
    password: '123456'
}
xhr.setRequestHeader('Content-Type', 'application/json')
xhr.send(a)
xhr.addEventListener('readystatechange', function () {
    if (xhr.readyState == 4 && xhr.status == 200) {
        let data = JSON.parse(xhr.responseText)
        console.log(data)
    }
})
```
